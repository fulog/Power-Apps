# Teams リマインドアプリ（Power Apps + Power Automate）

Microsoft Teams の投稿に対して、**リマインド送信やメンションを自動化する** Power Apps + Power Automate のサンプルです。

- チャンネルに対してリマインド投稿
- 「いいね」していない人だけにメンション
- 予約投稿 & 予約投稿のキャンセル

など、Teams 上の軽いタスク管理・リマインドに使える仕組みを Power Platform だけで実現しています。

ブログ記事で詳しく解説しています。

- [〖Power Apps+Automate〗Teamsで「いいね」してない人に対してメンションするアプリ](https://www.fulogabc.net/entry/power-apps-automate-teams-mention-people-who-did-not-like)

---

## 📌 このアプリでできること

### リマインド送信機能

- 対象の **チーム / チャンネル** を選択してリマインドを設定
- メッセージ内容を入力し、即時 or 指定日時で投稿
- チャンネルに対して通常のメンション付き投稿を行う

### 「いいねしてない人」メンション機能

- 対象のメッセージに対して「いいね」していないメンバーを抽出
- 抽出されたユーザーだけにメンション付きでリマインド送信
  - 「全員にもう一度通知」は避け、**反応していないメンバーだけ** にフォーカス

### 予約投稿 & キャンセル機能

- 将来の日時を指定して、Teams へのリマインド投稿を予約
- 予約時に「キャンセル用 URL」付きメッセージを自分あてに送信
- 後でその URL からアプリを起動すると、対象フロー実行をキャンセル
  - URL パラメータ（例：`Category` / `Id`）を利用してフロー実行 ID を特定し、キャンセル API を呼び出す

---

## 🧱 全体構成

このサンプルは **Power Apps（Canvas アプリ）** と **Power Automate（クラウドフロー）** のセットです。

### Power Apps

- チーム / チャンネル選択 UI
- リマインド内容・投稿種別（チャネル／いいねしてない人）・日時などを入力するフォーム
- 予約投稿キャンセルの OnStart ロジック
  - `Param("Category")`, `Param("Id")` から URL パラメータを取得
  - Power Automate 管理コネクタ等を利用して、該当フロー実行をキャンセル
  - キャンセル完了の通知を表示

### Power Automate

- Teams への投稿 / メンション実行フロー
- 対象メッセージのリアクション情報（「いいね」など）を取得し、未リアクションのユーザーを抽出
- 実行 ID を保存し、予約キャンセル用 URL に埋め込む仕組み
- 必要に応じて実行ログや管理情報を記録するためのデータソース（例：SharePoint リスト）


## ✅　前提条件
- Power Apps / Power Automate が利用できるライセンス
- Microsoft Teams コネクタが利用可能であること
- 以下のようなコネクタ・データが利用可能なこと
 - Microsoft Teams
 - Office 365 グループ（メンバー情報取得など）
 - （任意）Power Automate 管理コネクタ（実行キャンセルに利用）
- 対象のチーム・チャンネルに対して「投稿できる権限」があること


